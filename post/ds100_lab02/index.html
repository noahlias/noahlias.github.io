<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Lab02_WriteUp - Noahlias's Blog</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="Noahlias"><meta name=description content="dataset
Question 1 For this question we will use SQL to extract data out of the indiv_sample_nyc table. The schema for this table is given below.
Question 1a Let&amp;rsquo;s start by looking at 2016 election contributions made by Donald Trump, who was a NY resident during that year. Write a SQL statement that will return the cmte_id, transaction_amt, and name for every contribution made by any donor with &amp;ldquo;DONALD&amp;rdquo; and &amp;ldquo;TRUMP&amp;rdquo; in their name."><meta name=keywords content="Coding,Blog,Life"><meta name=generator content="Hugo 0.110.0 with theme even"><link rel=canonical href=https://noahlias.github.io/post/ds100_lab02/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><meta property="og:title" content="Lab02_WriteUp"><meta property="og:description" content="dataset
Question 1 For this question we will use SQL to extract data out of the indiv_sample_nyc table. The schema for this table is given below.
Question 1a Let&rsquo;s start by looking at 2016 election contributions made by Donald Trump, who was a NY resident during that year. Write a SQL statement that will return the cmte_id, transaction_amt, and name for every contribution made by any donor with &ldquo;DONALD&rdquo; and &ldquo;TRUMP&rdquo; in their name."><meta property="og:type" content="article"><meta property="og:url" content="https://noahlias.github.io/post/ds100_lab02/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-11-15T20:16:03+08:00"><meta property="article:modified_time" content="2022-11-15T20:16:03+08:00"><meta itemprop=name content="Lab02_WriteUp"><meta itemprop=description content="dataset
Question 1 For this question we will use SQL to extract data out of the indiv_sample_nyc table. The schema for this table is given below.
Question 1a Let&rsquo;s start by looking at 2016 election contributions made by Donald Trump, who was a NY resident during that year. Write a SQL statement that will return the cmte_id, transaction_amt, and name for every contribution made by any donor with &ldquo;DONALD&rdquo; and &ldquo;TRUMP&rdquo; in their name."><meta itemprop=datePublished content="2022-11-15T20:16:03+08:00"><meta itemprop=dateModified content="2022-11-15T20:16:03+08:00"><meta itemprop=wordCount content="984"><meta itemprop=keywords content="Pandas,Numpy,MatPlotlib,Writeup,Sql,Sqlite,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lab02_WriteUp"><meta name=twitter:description content="dataset
Question 1 For this question we will use SQL to extract data out of the indiv_sample_nyc table. The schema for this table is given below.
Question 1a Let&rsquo;s start by looking at 2016 election contributions made by Donald Trump, who was a NY resident during that year. Write a SQL statement that will return the cmte_id, transaction_amt, and name for every contribution made by any donor with &ldquo;DONALD&rdquo; and &ldquo;TRUMP&rdquo; in their name."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Noahlias</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Noahlias</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Lab02_WriteUp</h1><div class=post-meta><span class=post-time>2022-11-15</span><div class=post-category><a href=/categories/ds100/>DS100</a></div></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#question-1>Question 1</a><ul><li><a href=#question-1a>Question 1a</a></li><li><a href=#question-1b>Question 1b</a></li><li><a href=#question-1c>Question 1c</a></li><li><a href=#question-1d>Question 1d</a></li></ul></li><li><a href=#question-2>Question 2</a><ul><li><a href=#question-2a>Question 2a</a></li><li><a href=#question-2b>Question 2b</a></li><li><a href=#question-2c>Question 2c</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-content><a target=_blank href=https://colab.research.google.com/github/DS-100/fa20/blob/master/lab/lab02/lab02.ipynb><img src=https://colab.research.google.com/assets/colab-badge.svg alt="Open In Colab"></a><p><a href=https://s3.amazonaws.com/berkeley-ds100/fec_nyc.sqlite><code>dataset</code></a></p><h2 id=question-1>Question 1</h2><p>For this question we will use SQL to extract data out of the <code>indiv_sample_nyc</code> table. The schema for this table is given below.</p><h3 id=question-1a>Question 1a</h3><p>Let&rsquo;s start by looking at 2016 election contributions made by Donald Trump, who was a NY resident during that year. Write a SQL statement that will return the cmte_id, transaction_amt, and name for every contribution made by any donor with &ldquo;DONALD&rdquo; and &ldquo;TRUMP&rdquo; in their name.</p><p>Hint: You&rsquo;ll need to use <code>WHERE name LIKE '%TRUMP%' AND name LIKE '%DONALD%'</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q1a</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT
</span></span></span><span class=line><span class=cl><span class=s1>    cmte_id,
</span></span></span><span class=line><span class=cl><span class=s1>    transaction_amt,
</span></span></span><span class=line><span class=cl><span class=s1>    name
</span></span></span><span class=line><span class=cl><span class=s1>FROM indiv_sample_nyc
</span></span></span><span class=line><span class=cl><span class=s1>WHERE name like &#39;%TRUMP%&#39; and name like &#39;%DONALD%&#39;
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q1a</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q1a</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q1a</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=question-1b>Question 1b</h3><p>If we look at the list above, it appears that some donations were not by Donald Trump himself, but instead by an entity called &ldquo;DONALD J TRUMP FOR PRESIDENT INC&rdquo;. If we look at the list of donors, we see that our query only seems to have picked up one such anomalous name.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q1b</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT
</span></span></span><span class=line><span class=cl><span class=s1>    cmte_id,
</span></span></span><span class=line><span class=cl><span class=s1>    transaction_amt,
</span></span></span><span class=line><span class=cl><span class=s1>    name
</span></span></span><span class=line><span class=cl><span class=s1>FROM indiv_sample_nyc
</span></span></span><span class=line><span class=cl><span class=s1>WHERE name not like &#39;%DONALD J TRUMP FOR PRESIDENT INC%&#39; and name like &#39;%TRUMP%&#39; and name like &#39;%DONALD%&#39;
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q1b</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q1b</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q1b</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=question-1c>Question 1c</h3><p>As a review of some of the key ideas from CS61A/CS88, let&rsquo;s refine our query above.</p><p>We see that many of the contributions above were to the same committee. Create a new SQL query that returns the total amount that Donald Trump contributed to each committee. Your table should have three columns <code>cmte_id</code>, <code>total_amount</code>, and <code>num_donations</code>, where <code>total_amount</code> is the total amount contributed to that committee, and <code>num_donations</code> is the total number of donations. Your table should be sorted in decreased order of <code>total_amount</code>.</p><p>Hint: Use <code>GROUP BY</code> as covered in CS61A and CS88.</p><p>Hint: Use <code>COUNT(*)</code> as covered in CS61A and CS88.</p><p>Hint: Use <code>SUM()</code> as covered in CS61A and CS88.</p><p>Hint: Use <code>ORDER BY</code> as covered in CS61A and CS88.</p><p>Hint: Use <code>DESC</code> as covered in CS61A and CS88.</p><p>Hint: Your <code>WHERE</code> clause should be the same as question 1b.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q1c</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT
</span></span></span><span class=line><span class=cl><span class=s1>    cmte_id,
</span></span></span><span class=line><span class=cl><span class=s1>    sum(transaction_amt) as total_amount,
</span></span></span><span class=line><span class=cl><span class=s1>    count(*) as num_donations
</span></span></span><span class=line><span class=cl><span class=s1>FROM indiv_sample_nyc
</span></span></span><span class=line><span class=cl><span class=s1>WHERE name not like &#39;%DONALD J TRUMP FOR PRESIDENT INC%&#39; and name like &#39;%TRUMP%&#39; and name like &#39;%DONALD%&#39;
</span></span></span><span class=line><span class=cl><span class=s1>group by cmte_id
</span></span></span><span class=line><span class=cl><span class=s1>order by total_amount desc
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q1c</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q1c</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q1c</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=question-1d>Question 1d</h3><p>Now we&rsquo;d like to know the name of each committee, i.e. we want to know the name of the identity that Donald Trump was making contributions to. Modify your query from question 1c so that it also shows the name of each committee. That is, your table should have four columns <code>cmte_id</code>, <code>total_amount</code>, <code>num_donations</code>, and <code>cmte_nm</code>.</p><p>The names of the committees are given in the <code>cmte_nm</code> column of the <code>comm</code> table.</p><p>Hint: You&rsquo;ll need to join the <code>indiv_sample_nyc</code> and <code>comm</code> tables.</p><p>Hint: One approach is a nested select statement (a.k.a. subquery) as discussed in lecture.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>query_q1d</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>select a.cmte_id, a.total_amount,a.num_donations,b.cmte_nm
</span></span></span><span class=line><span class=cl><span class=s1>from (SELECT
</span></span></span><span class=line><span class=cl><span class=s1>    cmte_id,
</span></span></span><span class=line><span class=cl><span class=s1>    sum(transaction_amt) as total_amount,
</span></span></span><span class=line><span class=cl><span class=s1>    count(*) as num_donations
</span></span></span><span class=line><span class=cl><span class=s1>FROM indiv_sample_nyc
</span></span></span><span class=line><span class=cl><span class=s1>WHERE name not like &#39;%DONALD J TRUMP FOR PRESIDENT INC%&#39; and name like &#39;%TRUMP%&#39; and name like &#39;%DONALD%&#39;
</span></span></span><span class=line><span class=cl><span class=s1>group by cmte_id
</span></span></span><span class=line><span class=cl><span class=s1>order by total_amount desc) a
</span></span></span><span class=line><span class=cl><span class=s1>left join comm b on a.cmte_id = b.cmte_id
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q1d</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q1d</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q1d</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=question-2>Question 2</h2><h3 id=question-2a>Question 2a</h3><p>Let&rsquo;s select transactions in the <code>indiv_sample_nyc</code> table with a <code>cmte_id</code> (committee id) that ends in 5. Then, groupby the transactions in the <code>indiv_sample_nyc</code> table with the <code>cmte_id</code> column, and count how many transactions and how much total amount of contribution there are for each <code>cmte_id</code>. Select the top 5 committees ordered by the transaction count.</p><p>Your output should look similar to:</p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>committee_id</th><th>total_amount</th><th>count</th></tr></thead><tbody><tr><th>0</th><td>C00575795</td><td>25099091</td><td>110657</td></tr><tr><th>1</th><td>C00000935</td><td>6989835</td><td>36237</td></tr><tr><th>2</th><td>C00035675</td><td>316019</td><td>3417</td></tr><tr><th>3</th><td>C00040535</td><td>492567</td><td>3277</td></tr><tr><th>4</th><td>C00012245</td><td>499659</td><td>2128</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q2a</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT
</span></span></span><span class=line><span class=cl><span class=s1>    cmte_id AS committee_id,
</span></span></span><span class=line><span class=cl><span class=s1>    sum(transaction_amt) AS total_amount,
</span></span></span><span class=line><span class=cl><span class=s1>    count(*) AS count
</span></span></span><span class=line><span class=cl><span class=s1>FROM indiv_sample_nyc
</span></span></span><span class=line><span class=cl><span class=s1>where cmte_id like &#39;%5&#39;
</span></span></span><span class=line><span class=cl><span class=s1>group by cmte_id
</span></span></span><span class=line><span class=cl><span class=s1>order by count(*) desc limit 5
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q2a</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q2a</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q2a</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=question-2b>Question 2b</h3><p>When you printed the schema for the tables, you may have noticed that both the <code>cand</code> and <code>comm</code> tables have a <code>cand_id</code> column. Let&rsquo;s try joining these two tables on this column.</p><p>List the first 5 candidate names (<code>cand_name</code>) in reverse lexicographic order by <code>cand_name</code>, along with their corresponding committee names. Only select rows that have a matching <code>cand_id</code> in both tables.</p><p>Your output should look similar to:</p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>cand_name</th><th>cmte_nm</th></tr></thead><tbody><tr><th>0</th><td>ZUTLER, DANIEL PAUL MR</td><td>CITIZENS TO ELECT DANIEL P ZUTLER FOR PRESIDENT</td></tr><tr><th>1</th><td>ZUMWALT, JAMES</td><td>ZUMWALT FOR CONGRESS</td></tr><tr><th>2</th><td>ZUKOWSKI, ANDREW GEORGE</td><td>ZUKOWSKI FOR CONGRESS</td></tr><tr><th>3</th><td>ZUCCOLO, JOE</td><td>JOE ZUCCOLO FOR CONGRESS</td></tr><tr><th>4</th><td>ZORN, ROBERT ERWIN</td><td>CONSTITUTIONAL COMMITTEE</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q2b</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT c1.cand_name,c2.cmte_nm
</span></span></span><span class=line><span class=cl><span class=s1>FROM cand c1 inner JOIN comm c2 ON c1.cand_id=c2.cand_id
</span></span></span><span class=line><span class=cl><span class=s1>order by  c1.cand_name desc limit 5
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>res_q2b</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q2b</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q2b</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=question-2c>Question 2c</h3><p>As in the previous part, list the first 5 candidate names (<code>cand_name</code>) by reverse lexicographic order and their corresponding committee names (<code>cmte_nm</code>). This time, include all candidate names. If there is no matching <code>cand_id</code> in the <code>comm</code> table, then <code>cmte_nm</code> should be NULL.</p><p>Your output should look similar to:</p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>cand_name</th><th>cmte_nm</th></tr></thead><tbody><tr><th>0</th><td>ZUTLER, DANIEL PAUL MR</td><td>CITIZENS TO ELECT DANIEL P ZUTLER FOR PRESIDENT</td></tr><tr><th>1</th><td>ZUMWALT, JAMES</td><td>ZUMWALT FOR CONGRESS</td></tr><tr><th>2</th><td>ZUKOWSKI, ANDREW GEORGE</td><td>ZUKOWSKI FOR CONGRESS</td></tr><tr><th>3</th><td>ZUCCOLO, JOE</td><td>JOE ZUCCOLO FOR CONGRESS</td></tr><tr><th>4</th><td>ZORNOW, TODD MR</td><td>None</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>query_q2c</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>SELECT c1.cand_name,c2.cmte_nm
</span></span></span><span class=line><span class=cl><span class=s1>FROM cand c1 left JOIN comm c2 ON c1.cand_id = c2.cand_id
</span></span></span><span class=line><span class=cl><span class=s1>order by c1.cand_name desc limit 5
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>res_q2c</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_sql</span><span class=p>(</span><span class=n>query_q2c</span><span class=p>,</span> <span class=n>engine</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res_q2c</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><div class=post-tags><a href=/tags/pandas/>Pandas</a>
<a href=/tags/numpy/>Numpy</a>
<a href=/tags/matplotlib/>MatPlotlib</a>
<a href=/tags/writeup/>Writeup</a>
<a href=/tags/sql/>Sql</a>
<a href=/tags/sqlite/>Sqlite</a></div><nav class=post-nav><a class=prev href=/post/count-complete-tree-nodes/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Count Complete Tree Nodes</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=/post/ds100_lab01/><span class="next-text nav-default">Lab01_WriteUp</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=noahlias/noahlias.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=https://www.github.com/noahlias class="iconfont icon-github" title=github></a>
<a href=https://weibo.com/Alias21 class="iconfont icon-weibo" title=weibo></a>
<a href=https://space.bilibili.com/1741799 class="iconfont icon-bilibili" title=bilibili></a>
<a href=https://noahlias.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2022 -
2025<span class=heart><i class="iconfont icon-heart"></i></span><span>Noahlias</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script>
<script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-85629761-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>